import csv
import matplotlib.mlab as mlab
import matplotlib.pyplot as plt

map_month_date = (0, 31, 59, 90, 120, 151,
                  181, 212, 243, 273, 304, 334) 

class Toy:
	def __init__(self, row):
		self.toy_id = int(row[0])
		self.duration = int(row[2])
		self.date_time = tuple(map(int, row[1].split(" ")))
		self.minutes_from_day = self.date_time[4] + self.date_time[3]*60
		self.minutes_from_year = self.date_time[4] + self.date_time[3]*60 + \
                                 (self.date_time[2]-1+map_month_date[self.date_time[1]-1])*24*60
	def __repr__(self):
		return "(" + str(self.toy_id) + ", " + str(self.minutes_from_year) + ", " + \
               str(self.duration) + ")"

toy_list = []

with open('toys_rev2_sample10.csv', newline='\n') as csvfile:
	spamreader = csv.reader(csvfile, delimiter=',', quotechar='|')
	next(spamreader)
	for row in spamreader:
		toy_list.append(Toy(row))

minutes_from_day = tuple(map(lambda x: x.minutes_from_day, toy_list))
minutes_from_year = tuple(map(lambda x: x.minutes_from_year, toy_list))

#print(minutes_from_day)

plt.subplot(211)
num_bins = 24*60/10
n, bins, patches = plt.hist(minutes_from_day, num_bins, facecolor='green', alpha=0.5)
plt.xlabel('minute of the day')
plt.ylabel('count')
plt.title('distribution of the gifts compare to minute of the day')

plt.subplot(212)
num_bins = (365-21)*24*60/60/24
n, bins, patches = plt.hist(minutes_from_day, num_bins, normed=1, facecolor='green', alpha=0.5)
plt.xlabel('day of the year')
plt.ylabel('count')
plt.title('distribution of the gifts in a year')

plt.show()

#for toy in toy_list:
#	print(toy)
